// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UrgencyLevel {
  low
  medium
  high
  critical
}

enum RequestStatus {
  pending
  assigned
  resolved
  false_report
}

model Admin {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Request {
  id          String        @id @default(uuid())
  phone       String        @db.VarChar(20)
  fullName    String?       @db.VarChar(255)
  description String        @db.Text
  urgency     UrgencyLevel  @default(medium)
  images      String[]      // Array of image URLs
  location    Unsupported("geometry(Point,4326)") // PostGIS Point
  lat         Float         // Denormalized for easier queries
  lng         Float         // Denormalized for easier queries
  status      RequestStatus @default(pending)
  assignedTo  String?       @db.VarChar(255)
  adminNotes  String?       @db.Text
  createdAt   DateTime      @default(now())
  resolvedAt  DateTime?
  updatedAt   DateTime      @updatedAt

  @@index([phone])
  @@index([urgency])
  @@index([status])
  @@index([createdAt])
  @@index([lat, lng])
  @@map("requests")
}

